<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Edit Comment</title>
</head>
<body>
<h2>Edit Comment</h2>

<!-- Edit Comment Form -->
<form id="editCommentForm">
    <!-- Hidden field for the comment ID -->
    <input type="hidden" id="commentId" th:value="${comment.id}" />

    <div>
        <label for="name">Name:</label>
        <input type="text" id="name" th:value="${comment.name}" required />
    </div>

    <div>
        <label for="email">Email:</label>
        <input type="email" id="email" th:value="${comment.email}" required />
    </div>

    <div>
        <label for="comment">Comment:</label>
        <textarea id="comment" required th:text="${comment.comment}"></textarea>
    </div>

    <button type="button" onclick="updateComment()">Update Comment</button>
</form>

<a th:href="@{/post{id}(id=${comment.post.id})}">‚Üê Back to Post</a>

<script th:inline="javascript">
    function updateComment() {
        const commentId = [[${comment.id}]];
        const postId = [[${comment.post.id}]];

        const data = {
            name: document.getElementById('name').value,
            email: document.getElementById('email').value,
            comment: document.getElementById('comment').value
        };

        fetch('/post/comment' + commentId, {
            method: 'PUT',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        })
        .then(response => {
            if(response.ok){
                // Redirect back to the post view after successful update
                window.location.href = '/post' + postId;
            } else {
                alert('Error updating comment!');
            }
        })
        .catch(err => {
            console.error(err);
            alert('Error updating comment!');
        });
    }
</script>

</body>
</html>
